[
  {
    "path": "posts/2022-01-09-hawaii-albatross-tohoku-tsunami/",
    "title": "The Impact of the 2011 Tōhoku tsunami on albatross in Hawaii",
    "description": "A statisical analysis of the impact of the 2011 Tōhoku tsunami on albatross populations in Hawaii.",
    "author": [
      {
        "name": "Julia Parish",
        "url": "https://github.com/juliaparish"
      }
    ],
    "date": "2022-01-15",
    "categories": [
      "R",
      "GIS"
    ],
    "contents": "\n\nContents\nResearch Question\nBackground\nAnalysis Plan\nCollect Data\nVisualize Data\nConduct and Interpret Regression Analysis\nConclusion and Future Research\nCorrections\nSource Code\n\n\nThis is an image of Hōlanikū, also know as Kure Atoll, the northernmost landmass in the Hawaiian archipelago. It is located at 28.3925° N, 178.2936° W and is within the Papahānaumokuākea National Marine Monument.Image Credit: Kure Atoll Conservancy\nThis statistical analysis was completed as an assignment for my Master’s program course, Environmental Data Science 222: Statistics for Environmental Data Science.\nResearch Question\nWere albatross populations impacted by the 2011 Tōhoku tsunami event?\nResearchers estimated the Tōhoku tsunami flooded between 26% - 52% of all Black-footed albatross nests and impacted more than 275,000 albatross nests throughout Papahānaumokuākea (Reynolds et al. 2017). This post will attempt to analyze and quantify the impact of the Tōhoku tsunami on two Hawaiian albatross species, the Laysan albatross and the Black-footed albatross.\nBackground\nThe Hawaiian archipelago is home to thousands of albatrosses. Albatrosses are an incredible bird species that have inspired authors, the fashion industry, and birders across the globe. They live to be over 65 years old, have the largest wingspan of any bird, are monogamous rearers, and have nest-site fidelity (meaning they return to the same nest location every year). Three species of albatross breed in Hawaii, the Laysan (Phoebastria immutabilis), Black-footed (Phoebastria nigripes), and Short-tailed (Phoebastria albatrus) albatross. Laysan albatrosses are listed as near threatened due to threats from climate change to their habitat and breeding grounds and long-line fishing operations (Arata, Sievert, and Naughton 2009). The IUCN Red List of Threatened Species assessed the Black-footed albatross as near threatened in 2020 (List 2017). The Short-tailed albatross almost went extinct in the early 1900s due to feather hunting and is currently listed as an endangered species in the United States (Alaska Region, n.d.).\n\n\nShow code\n\ndata.frame(\"Common_name\" = c(\"Black-footed albatross\", \"Laysan albatross\", \"Short-tailed albatross\"),\n           \"Hawaiian_name\" = c(\"Kaʻupu\", \"Mōlī\", \"Makalena|Kaʻupuakea\"),\n           \"Species_code\" = c(\"BFAL\",\"LAAL\", \"STAL\"),\n           \"Scientific_name\" = c(\"Phoebastria nigripes\", \"Phoebastria immutabilis\", \"Phoebastria albatrus\")) %>% \n  kable(caption = \"Hawaiian Albatross Species Names\") %>%\n  kable_paper(full_width = FALSE) %>%\n  kable_styling(latex_options = \"striped\",\n                font_size = 15) %>% \n  column_spec(1, bold = T) %>%\n  row_spec(0, bold = T, color = \"black\")\n\n\n\nTable 1: Hawaiian Albatross Species Names\n\n\nCommon_name\n\n\nHawaiian_name\n\n\nSpecies_code\n\n\nScientific_name\n\n\nBlack-footed albatross\n\n\nKaʻupu\n\n\nBFAL\n\n\nPhoebastria nigripes\n\n\nLaysan albatross\n\n\nMōlī\n\n\nLAAL\n\n\nPhoebastria immutabilis\n\n\nShort-tailed albatross\n\n\nMakalena|Kaʻupuakea\n\n\nSTAL\n\n\nPhoebastria albatrus\n\n\n\nAdult and juvenile Laysan and Black-footed albatross on the coral runway of Hōlanikū (Kure Atoll).Image Credit: J. Parish\nPapahānaumokuākea, also known as the Northwestern Hawaiian Islands, are comprised of atolls, reefs, and pinnacles, and are where 95% of all Black-footed albatross and 99% of Laysan albatross nest (Arata, Sievert, and Naughton 2009). These low-lying islands are at extreme risk of inundation from tsunamis (Reynolds et al. 2017). On March 11, 2011, a 9.0 earthquake hit the Tōhoku region of Japan. The earthquake lasted over 6 minutes, creating a tsunami that impacted coastal areas and island nations throughout the Pacific region. Approximately 20,000 people lost their lives from the earthquake and resulting tsunami. The tsunami also killed or injured thousands of marine and terrestrial species. Many wildlife species found in the Papahānaumokuākea Marine National Monument (PMNM) were impacted by the Tōhoku tsunami.\nNote: The Short-tailed albatross was not included in this analysis as there is only one breeding pair in Hawaii.\nAnalysis Plan\nThis statistical analysis will be testing the hypothesis if the Tōhoku tsunami impacted albatross populations in Hawaii. The table below outlines the phases of the analysis.\n\\[H_{0}: There\\ was\\ no\\ impact\\ of\\ the\\ Tōhoku\\ tsunami\\ on\\ albatross\\ populations\\ in\\ Hawaii.\\] \\[H_{1}: There\\ was\\ an\\ impact\\ of\\ the\\ Tōhoku\\ tsunami\\ on\\ albatross\\ populations\\ in\\ Hawaii.\\]\n\n\nShow code\n\ndata.frame(\"Phase\" = c(1:5),\n           \"Description\" = c(\"Identify research question\",\n                             \"Collect data\",\n                             \"Visualize data\",\n                             \"Conduct regression analysis\",\n                             \"Conclusion & Future Research\")) %>% \n  kable(caption = \"Tōhoku Tsunami Impact Analysis Plan Outline\") %>%\n  kable_paper(full_width = FALSE) %>%\n  kable_styling(latex_options = \"striped\",\n                font_size = 15) %>% \n  column_spec(1, bold = T) %>%\n  row_spec(0, bold = T, color = \"black\")\n\n\n\nTable 2: Tōhoku Tsunami Impact Analysis Plan Outline\n\n\nPhase\n\n\nDescription\n\n\n1\n\n\nIdentify research question\n\n\n2\n\n\nCollect data\n\n\n3\n\n\nVisualize data\n\n\n4\n\n\nConduct regression analysis\n\n\n5\n\n\nConclusion & Future Research\n\n\nCollect Data\nAfter researching several data sources for albatross populations, I retrieved banding data for both Laysan and Black-footed albatross from the USGS Bird Banding Laboratory (BBL). The BBL has data on bird species for the past 100 years. The data contains information about an individual bird’s sex, age, health condition, and coordinates where the bird was banded. To access data from the BBL, it requires establishing an account on the USGS Bird Banding Lab Bander Portal website. Once you submit a data request, files will be available for download within 24 - 48 hours. I requested data for Black-footed and Laysan albatrosses in Hawaii between the years 1996 and 2020. Albatrosses reach reproductive maturity at nine years old on average. Data starting in 2019-2020 would reflect the cohort born in 2011 returning to nest and produce first young.\n\nAuthor and a colleague banding a juvenile Black-footed albatross.Image Credit: E. Opie\nVisualize Data\nUpon completion of data tidying and transformation, the next phase of analysis is to visualize the data.\nDistribution Map\nThe initial visualization was to map the banding data on to a map of Hawaii using the ggmap() package. The banding data point distribution accurately reflects the known species distribution of both species of albatross in Hawaii. The only two main Hawaiian Islands where albatross nest are Kauai and Oahu. This map shows most albatross populations reside with the PMNM.\n\n\nShow code\n\nalbie_map <- ggmap(hawaii_map) +\n  geom_point(aes(x = lon_dd, y = lat_dd, color = species_name),\n             data = albie_band,\n             size = 0.5,\n             alpha = 0.25) +\n  scale_color_manual(name = \"Albatross species\",\n                     values = c(\"#9E7E8C\", \"#39ACB1\"),\n                     labels = c(\"Black-footed Albatross\", \"Laysan Albatross\"),\n                     guide = guide_legend(override.aes = list(size = 3, alpha = 1))) +\n  annotate(\"rect\", xmin = -162.13, xmax = -161.78, ymin = 22.94, ymax = 23.22, \n           color = \"#728A72\", fill = \"white\", alpha = 0.2) +\n  annotate('text', x = -161.7, y = 23.3, \n           label = 'Nihoa', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -164.856, xmax = -164.55, ymin = 23.42, ymax = 23.74, \n           color = \"#728A72\", fill = \"white\", alpha = 0.2) +\n  annotate('text', x = -164.45, y = 23.8, \n           label = 'Mokumanamana', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -166.54, xmax = -165.88, ymin = 23.45, ymax = 24.11, \n           color = \"#728A72\", fill = \"white\", alpha = 0.0) +\n  annotate('text', x = -166.54, y = 24.3, \n           label = 'Lalo', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -168.19, xmax = -167.83, ymin = 24.82, ymax = 25.16, \n           color = \"#728A72\", fill = \"white\", alpha = 0.2) +\n  annotate('text', x = -167.8, y = 25.3, \n           label = 'Onunui', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -170.78, xmax = -170.46, ymin = 25.33, ymax = 25.68, \n           color = \"#728A72\", fill = \"white\", alpha = 0.2) +\n  annotate('text', x = -170.39, y = 25.8, \n           label = 'Kamokuokamohoalii', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -171.95, xmax = -171.45, ymin = 25.53, ymax = 26, \n           color = \"#728A72\", fill = \"white\", alpha = 0.0) +\n  annotate('text', x = -172, y = 26.2, \n           label = 'Kamole', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -174.21, xmax = -173.8, ymin = 25.84, ymax = 26.24, \n           color = \"#728A72\", fill = \"white\", alpha = 0.2) +\n  annotate('text', x = -173.85, y = 26.5, \n           label = 'Kapou', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -175.47, xmax = -174.9, ymin = 27.22, ymax = 27.61, \n           color = \"#728A72\", fill = \"white\", alpha = 0.2) +\n  annotate('text', x = -174.8, y = 27.7, \n           label = 'Kamole', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -176.16, xmax = -175.53, ymin = 27.57, ymax = 28.14, \n           color = \"#728A72\", fill = \"white\", alpha = 0.0) +\n  annotate('text', x = -175.97, y = 28.35, \n           label = 'Kuaihelani', color = 'black', size = 2.3, hjust = 0) +\n  annotate(\"rect\", xmin = -177.19, xmax = -177.6, ymin = 28.1, ymax = 28.4, \n           color = \"#728A72\", fill = \"white\", alpha = 0.0) +\n  annotate('text', x = -177.55, y = 28.65, \n           label = 'Holaniku', color = 'black', size = 2.3, hjust = 0) +\n  annotate('text', x = -177.5, y = 19.5, \n           label = 'Created: 2021 J. Parish\\nData Source: USGS Bird Banding Lab', \n           color = 'black', size = 1.5, hjust = 0) +\n  labs(title = \"Figure 1: Banded Albatross Species in the Hawaiian Archipelago\",\n        subtitle = \"1996 - 2020\",\n        x = \"Longitude\",\n        y = \"Latitude\") +\n  theme(legend.title = element_text(size=12, color = \"black\", face=\"bold\"),\n           legend.justification=c(0,1), \n           legend.position=c(0.72, 0.98),\n           legend.background = element_blank(),\n           legend.key = element_blank())\nalbie_map\n\n\n\n\nIn order to conduct an analysis on the albatross count data, I created a new column in the albatross banding data frame for the total count for albatrosses for each year between 1996 and 2020.\n\n\nShow code\n\nband_count <- albie_band %>% \n  group_by(species, year) %>% \n  summarise(total = sum(count))\n\n\n\nScatterplot\nTo conduct analysis on the albatross banding data, it is necessary to create a total count of albatross banded for each year from 1996 to 2020. Once a total count was summed, I used a line and point plot to visualize albatross count annually and added a line to indicate with the Tōhoku tsunami occurred (2011). This plot does suggest that there may be a negative effect from the Tōhoku tsunami on albatross populations as the counts drop significantly after 2011. It also shows that the number of banded Black-footed albatrosses declined more than Laysan albatrosses after the tsunami. This trend may reflect the data that Reynolds et al. found as Black-footed albatrosses’ nest along coastal areas whereas Laysan albatrosses tend to nest more inland or at higher elevations on islands (Reynolds et al. 2017).\n\n\nShow code\n\n#plot banding count data\n\nalbie_count_plot <- ggplot(band_count, aes(x = year, y = total, group = species)) +\n  geom_point(aes(color = species,\n                 shape = species)) +\n  geom_line(aes(color = species)) +\n  scale_color_manual(name = \"Albatross species\",\n                     values = c(\"#9E7E8C\", \"#39ACB1\"),\n                     labels = c(\"Black-footed Albatross (BFAL)\", \"Laysan Albatross (LAAL)\"),\n                     guide = guide_legend(override.aes = list(shape = c(19, 17)))) +\n  geom_vline(xintercept = 2011,\n             linetype = \"solid\",\n             color = \"goldenrod1\",\n             size = 2) +\n  guides(shape = FALSE) +\n  annotate(\"text\",\n           label = \"Tōhoku tsunami\",\n           x = 2014,\n           y = 4700,\n           color = \"black\",\n           size = 4) +\n  labs(title = \"Figure 2: Hawaii Albatross Count Based On Band Data\",\n       subtitle = \"Data source: USGS Bird Banding Lab\",\n       x = \"Year\",\n       y = \"Albatross Banded\",\n       color = \"Species\") +\n  theme_minimal() +\n  theme(legend.background = element_blank(),\n        legend.position = \"bottom\")  \n  \nalbie_count_plot\n\n\n\n\nPopulation Means\nI calculated the mean of banded albatross species between 1996 and 2020 as well as comparing the population means of each species pre- and post-tsunami event. These means indicate that more black-foot albatross is banded than Laysan albatross in Hawaii. This is an interesting data point as the total Laysan albatross population is larger than the Black-footed albatross population (VanderWerf 2012). The Laysan albatross actually holds the honor of having the largest population of all albatross species in the world (out of 21 species). Reviewing the two population mean tables also indicated that the number of banded albatrosses declined after the Tōhoku tsunami.\n\n\nShow code\n\npop_params_table <- knitr::kable(pop_params_summary,\n                                 digits = 0,\n                                 col.names = c('Albatross Species', 'Population Mean', 'Population Median', 'Population Max'),\n                                 align = \"lccc\",\n                                 caption = \"Hawaii Albatross Population Summary 1996 - 2021\") %>%\n  kable_paper(full_width = FALSE) %>%\n  kable_styling(latex_options = \"striped\",\n                font_size = 15) %>% \n  column_spec(1, bold = T) %>%\n  row_spec(0, bold = T, color = \"black\") #%>% \n  # save_kable(here(\"images/pop_params.png\"))\n\npop_params_table \n\n\n\nTable 3: Hawaii Albatross Population Summary 1996 - 2021\n\n\nAlbatross Species\n\n\nPopulation Mean\n\n\nPopulation Median\n\n\nPopulation Max\n\n\nBFAL\n\n\n2003\n\n\n2008\n\n\n4740\n\n\nLAAL\n\n\n1396\n\n\n902\n\n\n3447\n\n\n\n\nShow code\n\npop_mean_table <- knitr::kable(pop_mean,\n                               col.names = c('Species', 'Pre_Pop_Mean', 'Post_Pop_Mean'),\n                               caption = \"Hawaii Albatross Count Means Pre- & Post- Tōhoku Tsunami\") %>% \n  kable_paper(full_width = FALSE) %>%\n  kable_styling(latex_options = \"striped\",\n                font_size = 12) %>% \n  column_spec(1, bold = T) %>%\n  row_spec(0, bold = T, color = \"black\")\npop_mean_table\n\n\n\n(#tab:species means)Hawaii Albatross Count Means Pre- & Post- Tōhoku Tsunami\n\n\nSpecies\n\n\nPre_Pop_Mean\n\n\nPost_Pop_Mean\n\n\nBFAL\n\n\n3627.11\n\n\n517.8\n\n\nLAAL\n\n\n2778.89\n\n\n455.9\n\n\nConduct and Interpret Regression Analysis\nTo determine the distribution of the count data for both albatross species, I created Q-Q plots. The regression analysis used on the band count data was linear regression.\nQQ Plot\nThe QQ plots for both the Black-footed and Laysan albatross show that the distribution is kurtosis, or they have heavy tails. Neither count data for the albatross species have a normal distribution based on the QQ plots.\n\n\nShow code\n\nbfal_qqplot <- ggplot(bfal_count) +\n  geom_qq(aes(sample = total),\n          color = \"#9E7E8C\",\n          size = 3) +\n  geom_qq_line(aes(sample = total),\n            color = \"grey\") +\n  xlab(\"Normal distribution quantiles\") +\n  ylab(\"Sample quantiles\") +\n  labs(title = \"Figure 3: Black-footed Albatross (BFAL) QQ Plot\") +\n  theme_minimal() +\n  theme(line = element_blank(),\n        panel.grid = element_blank(),\n        strip.text = element_blank(),\n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(size = 10),\n        legend.position = \"none\")\nbfal_qqplot \n\n\n\n\n\n\nShow code\n\nlaal_qqplot <- ggplot(laal_count) +\n  geom_qq(aes(sample = total),\n          color = \"#39ACB1\",\n          shape = 17,\n          size = 3) +\n  geom_qq_line(aes(sample = total),\n            color = \"grey\") +\n  xlab(\"Normal distribution quantiles\") +\n  ylab(\"Sample quantiles\") +\n  labs(title = \"Figure 4: Laysan Albatross (LAAL) QQ Plot\") +\n  theme_minimal() +\n  theme(line = element_blank(),\n        panel.grid = element_blank(),\n        strip.text = element_blank(),\n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(size = 10),\n        legend.position = \"none\")\n\nlaal_qqplot \n\n\n\n\nSimple Linear Regression\nThe first regression I conducted on the albatross banding data was a simple linear regression.\n\\[ \\text{Albatross count}_i = \\beta_0 + \\beta_1 \\text{tsunami event}  + \\varepsilon_i \\]\n\n\nShow code\n\ntab_model(post_tsunami_simple_mod ,\n          pred.labels = c(\"Intercept (mean albatross count pre-tsunami)\", \"Avg. banded albatross count post-tsunami\"),\n          string.ci = \"Conf. Int (95%)\",\n          string.p = \"P-value\",\n          title = \"Table 4: Simple Linear Regression Model for Banded Albatross in Hawaii\",\n          digits = 4)\n\n\n\nTable 4: Simple Linear Regression Model for Banded Albatross in Hawaii\n\n\n \n\n\ntotal\n\n\nPredictors\n\n\nEstimates\n\n\nConf. Int (95%)\n\n\nP-value\n\n\nIntercept (mean albatross count pre-tsunami)\n\n\n2616.9667\n\n\n2274.2624 – 2959.6710\n\n\n<0.001\n\n\nAvg. banded albatross count post-tsunami\n\n\n-2169.0121\n\n\n-2695.8899 – -1642.1343\n\n\n<0.001\n\n\nObservations\n\n\n52\n\n\nR2 / R2 adjusted\n\n\n0.578 / 0.569\n\n\nThe result of the simple regression shows that the intercept, 2616, is the mean number of banded albatrosses in Hawaii prior to the Tōhoku tsunami event in 2011. The second predictor, or β1, is the mean banded albatrosses less than the intercept for any year after the tsunami. The mean albatross count is 447 for any year after the tsunami, which is a marked difference from the average of 2617 prior to the tsunami. There is a 5% chance that the average banded albatross will be between 2,2274 and 2,959 prior to the Tōhoku tsunami. The confidence interval post-tsunami shows that the mean will be -2,695 and -1,642 of the total albatrosses. Because the p-value is smaller than 0.05, the null hypothesis that there was no impact from the Tōhoku tsunami on albatross counts is rejected. The data provides convincing evidence that there is a negative difference in mean number of albatrosses post-tsunami. There is a statistically significant difference, at the 5% significance level, in the count of albatrosses in Hawaii. Based on the adjusted R-squared, this model explains 57% of the variation in the albatross count data around its mean.\nMultiple Linear Regression\nThe second regression I conducted on the albatross banding data was a multiple linear regression with an interaction term of the tsunami event on each albatross species.\n\\[ \\text{Albatross count}_i = \\beta_0 + \\beta_1 \\text{tsunami event} + \\beta_2 \\text{albatross species} + \\beta_3\\text{tsunami event:species} + \\varepsilon_i \\]\n\n\nShow code\n\ntab_model(interaction_model,\n          pred.labels = c(\"Intercept (mean BFAL count pre-tsunami)\", \"Mean BFAL count post-tsunami\", \"Mean LAAL count pre-tsunami\", \"Mean LAAL count compared to BFAL count post-tsunami\"),\n          string.ci = \"Conf. Int (95%)\",\n          string.p = \"P-value\",\n          title = \"Table 5: Multiple Linear Regression Model Results for Banded Albatross in Hawaii\",\n          digits = 4)\n\n\n\nTable 5: Multiple Linear Regression Model Results for Banded Albatross in Hawaii\n\n\n \n\n\ntotal\n\n\nPredictors\n\n\nEstimates\n\n\nConf. Int (95%)\n\n\nP-value\n\n\nIntercept (mean BFAL count pre-tsunami)\n\n\n3125.1333\n\n\n2676.1144 – 3574.1523\n\n\n<0.001\n\n\nMean BFAL count post-tsunami\n\n\n-2653.4061\n\n\n-3343.7333 – -1963.0788\n\n\n<0.001\n\n\nMean LAAL count pre-tsunami\n\n\n-1016.3333\n\n\n-1651.3420 – -381.3246\n\n\n0.002\n\n\nMean LAAL count compared to BFAL count post-tsunami\n\n\n968.7879\n\n\n-7.4823 – 1945.0580\n\n\n0.052\n\n\nObservations\n\n\n52\n\n\nR2 / R2 adjusted\n\n\n0.653 / 0.631\n\n\nThe result of the simple regression shows that the intercept, 3125, is the mean number of banded Black-footed albatrosses in Hawaii prior to the Tōhoku tsunami event in 2011. The second predictor, or β1, is the mean banded Black-footed albatrosses less than the intercept for any year after the tsunami. The mean count Black-footed albatross for any year after the tsunami is 472. This is a significant decline from the mean count of 3125 for any year before the tsunami. The β2 is the mean banded Laysan albatrosses less than the mean number of Black-footed albatross before the tsunami. The mean Laysan albatross count prior to the tsunami was 2,109. The β3 is the mean Laysan albatrosses count post-tsunami compared to Black-footed albatrosses’ post-tsunami. This is also the interaction term. There are, on average, 969 more Laysan albatrosses than Black-footed albatrosses for any year after the Tōhoku tsunami.\nSince the p-values are smaller than 0.05, the null hypothesis that there was no impact from the Tōhoku tsunami on albatross counts is rejected. The data provides convincing evidence that there is a negative difference in mean number of both Black-footed and Laysan albatrosses post-tsunami. There is a statistically significant difference, at the 5% significance level, in the count of albatross in Hawaii. The p-value is greater than 0.05 when comparing the mean Laysan albatross count post-tsunami to the Black-footed albatross. This predictor may indicate that Laysan albatross counts were not as significantly impacted by the tsunami as Black-footed albatross. Based on the adjusted R-squared, this model explains 63% of the variation in the albatross count data around its mean.\nConclusion and Future Research\nIn conclusion, the linear regression model predicts that there are significant negative relationships between the independent variable (years before and after tsunami) and the dependent variable (count of banded albatross). It was also found that a multiple regression with an interaction term based on the tsunami event impact of each albatross species is a better model fit. This analysis suggests that the Tōhoku tsunami had a negative impact on albatross populations in Hawaii.\nFor future analysis on the impact of the Tōhoku tsunami, I would like to research what other variables may be influencing the number of albatrosses being banded by biologist in Hawaii each year. I have a suspension that there has been reduced banding effort throughout the archipelago since the tsunami, especially in 2020 due to the pandemic. I do not know why there would be a reduction in banding effort, but this may be a significant influence on the count data used for this analysis. I would also like to contact researchers in Hawaii to determine if there is more comprehensive census data for albatross.\n\nTwo Black-footed albatross practicing their mating dances and calls, while a Laysan albatross sits quietly on a nest in the background. The Black-footed albatross on the right has been banded with two types of bands (color and incoloy metal). The Black-footed albatross on the left has not been banded.Image Credit: I. Nimz\nCorrections\nIf you see mistakes or want to suggest changes, please create an issue on the source repository.\nSource Code\nFind the source code for this blog post here.\n\n\n\nAlaska Region, U. S. Fish Wildlife Service -. n.d. “Short-Tailed Albatross (Phoebastria Albatrus).” https://www.fws.gov/alaska/pages/endangered-species/short-tailed-albatross.\n\n\nArata, Javier, Paul Sievert, and Maura Naughton. 2009. “Status Assessment of Laysan and Black-Footed Albatrosses, North Pacific Ocean, 1923-2005.” U.S. Geological Survey Scientific Investigations Report 2009-5135: 80. https://pubs.usgs.gov/sir/2009/5131/.\n\n\nList, IUCN Red. 2017. “Black-Footed Albatross.” https://www.iucnredlist.org/species/22698350/181896323.\n\n\nReynolds, Michelle H., Paul Berkowitz, John Klavitter, and Karen Courtot. 2017. “Lessons from the Tōhoku Tsunami: A Model for Island Avifauna Conservation Prioritization.” Ecology and Evolution 7 (15): 5873–90. https://doi.org/10.1002/ece3.3092.\n\n\nVanderWerf, Eric. 2012. “Hawaiian Bird Conservation Action Plan.” Pacific Rim Conservation. https://pacificrimconservation.org/wp-content/uploads/2013/10/Introduction%202.pdf.\n\n\n\n\n",
    "preview": "posts/2022-01-09-hawaii-albatross-tohoku-tsunami/images/laal.JPG",
    "last_modified": "2022-01-16T22:12:21-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-12-01-mapping-habitat-remote-sensing/",
    "title": "Mapping Habitat Suitability of Sophora gypsohila",
    "description": "Mapping habitat suitability for the identification and conservation of the Guadalupe Mountain necklacepod (Sophora gypsophila) using Landsat 8 data",
    "author": [
      {
        "name": "Julia Parish, Wylie Hampson, Shale Hunter, Alex Vand",
        "url": "https://github.com/jaws-bren"
      }
    ],
    "date": "2021-12-01",
    "categories": [
      "R",
      "Remote Sensing"
    ],
    "contents": "\n\nContents\nProject Details\nInstallation\nPython Packages\n\nUsage\nReal-color Landsat visualization\nAnalysis parameters\n\nResults\nFuture Research and Other Use Cases\nReferences\n\nThis remote sensing project was completed as an assignment for my Master’s program course, Environmental Data Science 220: Remote Sensing.\nProject Details\nThis project was created to provide an introduction to using satellite data from the USGS Landsat 8 Level 2, Collection 2, Tier 1 sourced from Google Earth Engine for analysis to identify soil composition.\nLandsat 8 is a joint effort between USGS and NASA, with data collected from 2013-04-11 to the present. This particular dataset is the atmospherically corrected surface reflectance and land surface temperature from the Landsat 8 OLI/TIRS sensors.\nThis project used the Google Earth Engine API to download Landsat 8 data in order to explore potential habitat for an endangered plant species. By comparing NDVI and OIF bands, this study was able to determine possible regions of high gypsum concentration in the Guadalupe Mountains. All analysis was completed in Jupyter Lab using Python.\nInstallation\nPython Packages\nee\ngeemap\npandas\npprint\nUsage\nIdentifying Gypsic Soils Using Landsat 8 Data Mapping habitat suitability for the identification and conservation of the Guadalupe Mountain necklacepod (Sophora gypsophila)\nSophora gypsophila is a G1 Critically Endangered shrub in the pea family endemic to a small area surrounding the Guadalupe mountains in Southeastern New Mexico and Western Texas. Part of what puts S. gypsophila at risk is the fact that it is a substrate obligate - in other words, it can only survive in a specific soil type. But this also gives us an advantage: it means that we can identify potentially suitable habitat simply by mapping the gypsic areas in the vicinity of existing populations of S. gypsophila and subsetting these areas by the plant’s known elevation range. This can be done using Landsat bands 1, 5, and 7, taking advantage of the fact that gypsic soils are highly reflective in band 5 but particularly nonreflective in band 7.\nReal-color Landsat visualization\nPotential suitable habitat for Sophora gypsophila is located in the Guadalupe Mountain range of southern New Mexico and western Texas. This region of interest was defined through research by Stafford et al. (2008). We set the parameters that will be needed for this analysis by creating a buffer with a 50km radius around the known species habitat area. The Landsat images that correspond with this region of interest were downloaded using the Google Earth Engine API.\nReading in the data from Google Earth EngineCreating region of interestAnalysis parameters\nFirst, we use the difference between bands 6 and 7 divided by their sum (normalized ratio similar to NDVI calculation) to identify the normalized difference gypsum index for gypsic soils. The equation is Band 6 - Band 7)/(Band 6 + Band 7). We expect to produce a map that displays white for potential areas with high gypsic content.\nPython Normalized Difference for Gypsum SoilResults\nWe expected a map to display areas with high gypsic soils as white. There was a problem with the initial result as some areas area clearly identified as crop circles show up white in addition to soils with high gypsum content. This means that vegetation is also being detected by our normalized difference gypsum index band - not what we want.\nIntermediate analysisTo fix this, we added another band, this time calculating Normalized Difference Vegetation Index (NDVI) with the same math we used to calculate the normalized difference gypsum index, but using bands 4 (red) and 5 (near-infrared).\nNDVI is a dimensionless index that captures the difference between visible and near-infrared reflectance used to estimate vegetation cover.\nBy mapping normalized difference gypsum index and NDVI together, we should be able to differentiate between soil and vegetation: this is because vegetation will appear in both bands (show in purple below), but gypsic soils will only appear in normalized difference gypsum index (shown in red below).\n In summary, this project used the Google Earth Engine API to download Landsat 8 data in order to explore potential habitat for an endangered plant species. Sophora gypsophila is endangered, therefore data for known locations is not available to the public. By comparing NDVI and normalized difference gypsum index bands, this study was able to determine possible regions of high gypsum concentration in the Guadalupe Mountains. These gypsic soil regions are potential suitable habitat to rare, endemic species such as Sophora gypsophila.\nGypsic soil areas were mapped using the difference ratio of Bands 6 and 7. After plotting the normalized difference gypsum index with the NDVI we can see areas that are presumed to be gypics soils standout much more compared to areas that are known to have vegetation.\nFuture Research and Other Use Cases\nThis analysis use case allows biologist to prioritize areas of potential habitat suitability for survey for rare, threatened species such as S. gypsophila. Field surveys could be conducted to determine predictive accuracy via ground truthing. Another consideration to calculate more precise estimates for S. gypsophila habitat would be to overlay an elevation map and select for gypsic soil and elevation range. The known elevation range of S. gypsophila populations is between 1,000 and 5,000 feet above sea level. Combining both areas of high gypsic soil and elevation data would provide more precise suitabile habitat areas. An additional step in adapting Landsat data for conservation purposes would be comparing the identified potential Sophora habitat with land ownership maps in the region to target separate management solutions for public and private land.\nGeneral uses for this type of analysis is far reaching. Federal agencies or renewable energy developers could use this analysis to predict areas where rare or threatened plant species may be located but there is a lack of accurate population distribution documentation, areas coined as “botanical black holes”. Identifying areas that may have high level of endemism may assist with environmental impact assessments or future graduate research sites. This analysis could also be used identifying locations for new agricultural areas or for potential renewable energy development suitablility. Similar case studies have successfully identified soils with high salts content.\nReferences\nBinte Mostafiz, R.; Noguchi, R.; Ahamed, T. Agricultural Land Suitability Assessment Using Satellite Remote Sensing-Derived Soil-Vegetation Indices. Land 2021, 10, 223. https://doi.org/10.3390/land10020223\nBoettinger, J., Ramsey, R., Bodily, J., Cole, N., Kienast-brown, S., Nield, S., Saunders, A., & Stum, A. (2008). Landsat Spectral Data for Digital Soil Mapping. Digital Soil Mapping with Limited Data. https://doi.org/10.1007/978-1-4020-8592-5_16\nBrowning, D. M., & Duniway, M. C. (2011). Digital Soil Mapping in the Absence of Field Training Data: A Case Study Using Terrain Attributes and Semiautomated Soil Signature Derivation to Distinguish Ecological Potential. Applied and Environmental Soil Science, 2011, e421904. https://doi.org/10.1155/2011/421904\nLandsat Collection 2 Summary and Sample Metadata Now Available. (2019). Landsat Science. Retrieved November 28, 2021, from https://landsat.gsfc.nasa.gov/article/landsat-collection-2-summary-and-sample-metadata-now-available\nLandsat 8 data courtesy of the U.S. Geological Survey. https://developers.google.com/earth-engine/datasets/catalog/LANDSAT_LC08_C02_T1_L2#image-properties\nNield, S. J., Boettinger, J. L., & Ramsey, R. D. (2007). Digitally Mapping Gypsic and Natric Soil Areas Using Landsat ETM Data. Soil Science Society of America Journal, 71(1), 245–252. https://doi.org/10.2136/sssaj2006-0049\nRidwan, M. A., Radzi, N., Ahmad, W., Mustafa, I., Din, N., Jalil, Y., Isa, A., Othman A., Zaki, W. Applications of Landsat-8 Data: Survey. Internation Journal of Engineering & Techonology 2018, 11, 436-441. DOI:10.14419/ijet.v7i4.35.22858\nSophora gypsophila | NatureServe Explorer. (n.d.). Retrieved November 16, 2021, from https://explorer.natureserve.org/Taxon/ELEMENT_GLOBAL.2.155365/Sophora_gypsophila\nSoil Survey Manual - Ch. 5. Digital Soil Mapping | NRCS Soils. (n.d.). Retrieved November 16, 2021, from https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/ref/?cid=nrcs142p2_054255\nStafford, K., Rosales Lagarde, L., & Boston, P. (2008). Castile evaporite karst potential map of the Gypsum Plain, Eddy County New Mexico and Culberson County, Texas: A GIS methodological comparison. J Cave Karst Stud, 70.\nTexas Native Plants Database. (n.d.). Retrieved November 16, 2021, from https://aggie-horticulture.tamu.edu/ornamentals/nativeshrubs/sophoragypsophila.htm\nVermote, E., Justice, C., Claverie, M., & Franch, B. (2016). Preliminary analysis of the performance of the Landsat 8/OLI land surface reflectance product. Remote Sensing of Environment, 185, 46-56.\n\n\n\n",
    "preview": "posts/2021-12-01-mapping-habitat-remote-sensing/images/sophora.jpeg",
    "last_modified": "2022-01-15T23:20:05-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-10-03-life-expectancy/",
    "title": "Cartography Assignment",
    "description": "Maps for life expectacy in Africa and South America",
    "author": [
      {
        "name": "Grace Kumaishi, Julia Parish",
        "url": "https://github.com/juliaparish"
      }
    ],
    "date": "2021-11-13",
    "categories": [
      "R",
      "GIS"
    ],
    "contents": "\n\nContents\nProject Goal\nStep One\nStep Two\nConclusion\n\n\nThis cartography project was completed as an assignment for my Master’s program course, Environmental Data Science 233: Spatial Analysis. It was collaboration with G. Kumaishi.\nProject Goal\nCreate a map of life expectancy for South America and Africa.\nStep One\nCreate two separate maps for life expectancy data of South America and Africa using spData and tmap.\nLife Expectancy in Africa:\n\n\nShow code\n\n### Africa ###\n\nworld_africa <- world[world[[\"continent\"]] == \"Africa\", ] # create a subset of the world dataset of just the African continent\n\nlifeexp_africa <- tm_shape(world_africa) + # store map in order to combine\n  tm_polygons(col = \"lifeExp\", # select life expectancy data\n            palette = \"YlOrBr\", # Yellow Orange Brown color palette from RColorBrewer\n            style = \"pretty\", # familiar GIS discrete options available such as quantile, equal, jenks, etc.\n            title = \"Life Expectancy (years)*\", # legend title lives within tm_polygons\n            textNA = \"No Data\") +   # converted \"Missing\" legend default to \"No Data\"\n  tm_layout(inner.margins = c(0.1, 0.1, 0.1, 0.1), # margins between 0-1 (bottom, left, top, right)\n            legend.title.size = 1,\n            legend.text.size = .8,\n            bg.color = \"lightblue\", # background color\n            title = \"Africa\") + # map title lives under tm_layouts\n  tm_compass(type = \"4star\", # other compass styles available\n            show.labels = 1, # specifies compass label options\n            size = 3,\n            position = c(\"right\", \"top\")) +\n  tm_credits(\"Life expectancy data for the\\nAfrican continent uses 5-year\\nclassification breaks.\\nSource: SpData \\n \\n*Note that the color scale differs\\nbetween continents.\", # credit data source including github link; \\n creates text break\n            size = .5, # can't figure out how to make size bigger...\n            position = c(\"right\", \"bottom\"), \n            align = \"right\", # only applicable if using multiple lines\n            width = NA) # 1 is the whole map width, NA is determined by width of text\n\nlifeexp_africa\n\n\n\n\nFigure 1: Life Expectancy in Africa\n\n\n\nLife Expectancy in South America:\n\n\nShow code\n\n### South America ###\n\nworld_sa <- world[world[[\"continent\"]] == \"South America\", ] # create a subset of the world dataset of just the South American continent\n\nlifeexp_sa <- tm_shape(world_sa) + # store map in order to combine\n  tm_polygons(col = \"lifeExp\", # select life expectancy data\n            palette = \"YlOrBr\", # Yellow Orange Brown color palette from RColorBrewer\n            n = 5, # specify number of breaks\n            style = \"pretty\", # familiar GIS discrete options available such as quantile, equal, jenks, etc.\n            title = \"Life Expectancy (years)*\", # legend title lives within tm_polygons\n            textNA = \"No Data\") + # converted \"Missing\" legend default to \"No Data\"\n  tm_layout(inner.margins = c(0.1, 0.25, 0.1, 0.25), # margins between 0-1 (bottom, left, top, right)\n            legend.position = c(\"right\", \"bottom\"), \n            legend.title.size = 1,\n            legend.text.size = .8,\n            bg.color = \"lightblue\", # background color\n            title = \"South America\") + # map title lives under tm_layouts\n  tm_compass(type = \"4star\", # other compass styles available\n             show.labels = 1, # specifies compass label options\n             size = 3,\n             position = c(\"right\", \"top\")) +\n  tm_credits(\"Life expectancy data\\nfor the South American continent uses\\n2-year classification breaks.\\nSource: SpData \\n \\n*Note that the color scale differs\\nbetween continents.\", # credit data source including github link; \\n creates text break\n             position = c(\"left\", \"bottom\"), \n             align = \"left\",\n             size = .5) + \n  tm_credits(\"\", # explain varying color scales b/w two continents; \\n creates text break\n             position = c(\"right\", \"bottom\"), \n             align = \"right\",\n             size = .3)\n  \nlifeexp_sa\n\n\n\n\nFigure 2: Life Expectancy in South America\n\n\n\nStep Two\nCombine the two maps using tmap_arrange to compare and contrast life expectancy rates.\nLife Expectancy in South America and Africa:*\n\n\nShow code\n\ncombined_lifeexp <- tmap_arrange(lifeexp_sa,lifeexp_africa) # combine the two life expectancy maps using tmap_arrange\n\ncombined_lifeexp\n\n\n\n\nFigure 3: Fig 3: A Comparision of Life Expectancy between South America and Africa\n\n\n\nConclusion\nThis project was to practice creating maps in R using sf, tmap, and spData packages.\n\n\n\n",
    "preview": "posts/2021-10-03-life-expectancy/images/combined_lifeexp.png",
    "last_modified": "2022-01-30T14:40:23-08:00",
    "input_file": "lifeexpectancy.knit.md",
    "preview_width": 2100,
    "preview_height": 2100
  },
  {
    "path": "posts/2021-11-13-seasurface-temp-corals/",
    "title": "What is the effect of sea surface temperature on coral bleaching?",
    "description": "A synthesis project merging different datasets to gain new insights sea surface temperature on coral bleaching.",
    "author": [
      {
        "name": "Julia Parish, Cullen Molitor, Ryan Munnikhuis, and Desik Somasundaram",
        "url": "https://github.com/desik23/eds-213-group-project"
      }
    ],
    "date": "2021-11-13",
    "categories": [
      "R"
    ],
    "contents": "\n\nContents\nEnvironmental Question:\nData Management and Analysis Workflow\nPotential Legal Implications\n\nData Download Process\nRead in coral data from DataOne\nRead in Oceanic Niño Index (ONI) dataset\n\nData Analysis\nJoining the two datasets (ONI and coral reef) and calculating the Simpson’s Diversity Index\n\nVisualizing the data\nPlotting coral diversity data with the ONI color bar\n\nData Preservation\nData Sources:\n\n\n\nShow code\n\nlibrary(metajam)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(lubridate)\nlibrary(httr2)\nlibrary(purrr)\nlibrary(janitor)\nlibrary(XML)\nlibrary(zoo)\nlibrary(vegan)\n\n\n\nThis group project was completed as an assignment for my Master’s program course, Environmental Data Science 213: Metadata Standards, Data Modeling, and Data Semantics. The goal of the group project was to practice the re-use of data for a synthesis project merging different datasets to get new insights, as well as preserving scientific products on a data repository.\nEnvironmental Question:\nWhat is the effect of sea surface temperature on coral bleaching?\nOur group discovered the Scott Reef and Rowley Shoals Coral Bleaching Data dataset while searching the DataOne repository for “coral bleaching.” This particular dataset focuses on long-term monitoring data from 1994 to 2017 at reef slope habitats off the coast of northwestern Australia. The metadata includes the reef system, date range, taxonomy, habitat type, coral coverage, and dataset methods.\nSearch terms: coral bleaching, El Nino effect data, sea surface temperature data, species diversity\nData Management and Analysis Workflow\nCoral data was downloaded for the local coral reef ecosystems at Rowley Shoals (RS) and Scott Reef (SR) systems in Northwest Australia. Data on the monthly input to Ocean Nino Index was used to compute the 3 month mean of the temperature anomaly. Both datasets were combined to align the time periods. Then a Simpson’s Diversity Index (SDI) was computed using the functions available in the vegan R package to draw the potential relationships between the temperature anomaly and coral species diversity. The data will be preserved until the SDI methodology has been superseded by more significant research. Our group used a KNB project repository to preserve our data due to their reputation, reliability and commitment to the future in case of company changes.\nPotential Legal Implications\nCurrently, there are no legal constraints associated with acquiring, using and sharing the project data that we are aware of.\nData Download Process\nRead in coral data from DataOne\n\n\nShow code\n\n# assign data url to access coral data from DataOne then download\ndata_url <- \"https://cn.dataone.org/cn/v2/resolve/https%3A%2F%2Fpasta.lternet.edu%2Fpackage%2Fdata%2Feml%2Fedi%2F952%2F1%2Ff6212784c45d0a077f2c863868d22c4b\"\n\n# If data is already up to date, this will throw an error\n# error=T in header will move past this issue\n#download_d1_data(data_url, dir_name = \"data\", path = \".\")\n\n\n\n\n\nShow code\n\n# Read in data with metajam\ncoral_list <- read_d1_files(data_path)\n\n\n\nRead in Oceanic Niño Index (ONI) dataset\n\n\nShow code\n\n# Read in  ONI to be joined to coral data\noni <- read.table(\n  \"https://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/detrend.nino34.ascii.txt\",\n  header = T) %>%\n  dplyr::mutate(date = as.Date(ISOdate(YR, MON, 1)),\n                date_start = as.Date(ISOdate(YR, MON, 1)),\n                date_end = ceiling_date(date_start, \"month\")) %>%\n  dplyr::rename(oni_anomaly = ANOM,\n                month = MON,\n                year = YR) %>% \n  dplyr::select(year, month, oni_anomaly, date_start, date_end) %>% \n  dplyr::mutate(roll_3_month_mean = zoo::rollmean(x = oni_anomaly, k = 3, fill = NA, align = \"right\")) %>% \n  filter(date_start > ymd(\"1994-09-01\"))\n\n\n\nData Analysis\nJoining the two datasets (ONI and coral reef) and calculating the Simpson’s Diversity Index\nSimpson’s Diversity Index is a measure of diversity which takes into account the number of species present, as well as the relative abundance of each species. As species richness and evenness increase, diversity increases.\n\n\nShow code\n\n# join corals and ONI data\ncoral_oni <- corals %>% \n  pivot_longer(cols = 5:18, names_to = \"species\", values_to = \"cover\") %>% \n  dplyr::group_by(system, reef, year, month, location) %>% \n  dplyr::summarise(simpson_index = vegan::diversity(cover, index = \"simpson\")) %>% \n  dplyr::left_join(oni %>% select(-date_start, -date_end)) %>% \n  dplyr::mutate(date = lubridate::make_date(year = year, month = month, day = 1))\n\n\n\nVisualizing the data\nPlotting coral diversity data with the ONI color bar\n\n\nShow code\n\nggplot2::ggplot() +\n  ggplot2::geom_rect(\n    data = oni,\n    aes(xmin = date_start, xmax = date_end, ymin = -Inf, ymax = .3, fill = oni_anomaly)) +\n  ggplot2::scale_fill_viridis_c(\n    option = \"plasma\",\n    guide = guide_colorbar(direction = \"horizontal\", title.position = \"top\",\n                           order = 2, barheight = unit(.2, \"cm\"))) +\n  ggplot2::scale_x_date(date_breaks = \"2 year\", date_labels = \"%Y\", expand = expansion(mult = c(0,0))) +\n  ggplot2::geom_line(data = coral_oni, size = 1,\n                     aes(x = date, y = simpson_index, color = location)) +\n  ggplot2::scale_color_viridis_d() +\n  ggplot2::guides(color = guide_legend(order = 1)) +\n  ggplot2::labs(fill = \"Oceanic Ni\\u00f1o Index\", color = \"Sites\", \n                x = \"Date\", y = \"Simpsons Diversity Index\") +\n  ggplot2::theme_minimal()\n\n\n\n\nSimpson’s Diversity Index calculated by site from 14 taxa of corals plotted from 1994 to 2021. The Oceanic Niño Index monthly values are plotted as a colorbar to highlight duration and intensity of sea surface temperatures in the Niño region 3.4.\nData Preservation\nOur group used a Knowledge Network for Biocomplexity (KNB) project repository to preserve our data due to its reputation, reliability, and commitment to the future access regardless of transitions with in the organization. Data will be preserved and relevant until the Simpson’s Diversity Index methodology has been superseded by more significant research.\nKNB Ecoinformatic site\nData Sources:\nJames P Gilmour, Kylie L Cook, and Nicole M Ryan. 2021. Scott Reef and Rowley Shoals Coral Bleaching Data. Environmental Data Initiative.LTER Data Access - Download Method: metajam data_downloade API - Spatial Coverage: Scott Reef and Rowley Reef Ecosystems in - Northwestern Australia - Temporal Coverage: 1994 to 2020 - Parameters of Interest for Analysis: Species Population\nNOAA/ National Weather Service National Centers for Environmental Prediction Climate Prediction Center Oceanic Niño Index (ONI).NOAA ENSO Data - Download Method: read.table from base R - Spatial Coverage: 5N to 5S, 170W to 120W - Temporal Coverage: 1950 to 2021 - Parameters of Interest for Analysis: SST Anomaly\n\n\n\n",
    "preview": "posts/2021-11-13-seasurface-temp-corals/images/rowleycredit-scott-portelli.jpg",
    "last_modified": "2022-01-29T19:01:51-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-10-25-winterstormuri/",
    "title": "Effects of Winter Storm Uri",
    "description": "An analysis on the effects of the mega winterstorm Uri on power utilities in Houston, Texas",
    "author": [
      {
        "name": "Grace Kumaishi, Julia Parish",
        "url": "https://github.com/juliaparish"
      }
    ],
    "date": "2021-10-25",
    "categories": [
      "R",
      "GIS"
    ],
    "contents": "\n\nContents\nWinter Storm Uri and the Texas Freeze\n1) Access and wrangle the lights data:\na. Load DNB dataset from VNP46A1 granules using provided function:\nb. Invoke the function:\nc. Combine tiles into single raster for each date:\nd. Subtract stars objects to determine blackout locations:\ne. Vectorize the blackout mask and fix invalid geometries:\nf. Create ROI and crop the blackout dataset:\ng. Visualize the Feb 16th blackout:\n\n2) Access and wrangle the roads data:\na. Load data using SQL query:\nb. Buffer highways by 200 meters.\nc. Dissolve buffers:\nd. Create Houston basemap:\ne. Visualize highway buffers in Houston:\n\n3) Access and wrangle the buildings data:\na. Load data using SQL query:\n\n4) Access and wrangle the census tract data:\na. Access the census data:\nb. Extract the GEOID and median income fields:\nc. Merge geometry and income datasets:\n\n5) Merge the datasets\na. Remove the buffer from the blackout mask:\nb. Find all residential buildings in blackout areas:\nc. Spatially join the data:\n\n6) Analysis\nHow many residential buildings were without power on 2021-02-16?\nIs there a socioeconomic metric that predicts being affected by the power outage?\nReferences:\n\n\n\nWinter Storm Uri and the Texas Freeze\nOn February 13th, a major winter storm developed off the Pacific Northwest coast of the U.S. The storm, known as Winter Strom Uri, affected the continental U.S., Canada, and Northern Mexico. Winter Storm Uri caused widespread power outages, damage to residential water systems, and hundreds of fatalities in Texas alone (KUT 2021). The storm, which lasted from February 13 to February 17, produced blizzards, ice storms, tornadoes and record snow fall levels. It is the costliest winter storm in US history (NOAA 2021). It disproportionately affected Texas due to the State’s lack of adequate electrical and water supply winterization infrastructure, isolation from national power grid and a deficiency in prior experience with prolonged freezing temperatures. According to a University of Houston report, Winter Storm Uri caused more damage and loss of life in Harris County than anywhere else in North America. The report estimated that 91% of Harris County residents lost power during the storm and 65% were left without access to potable water. This assignment analyzes how many residential buildings lost power on February 16 and if residential median income would serve as a predictor for where power outages were located in Harris County.\n1) Access and wrangle the lights data:\nThe night lights data used for this analysis comes from NASA’s Worldview website. The dates 2021-02-07 and 2021-02-16 were chosen due to image clarity and lack of cloud cover. After acquiring the data for those two days, the images were converted to raster objects and used to calculate the difference in night light intensity to approximate the area of Houston that lost power during the storm.\na. Load DNB dataset from VNP46A1 granules using provided function:\n\n\nShow code\n\nread_dnb <- function(file_name) {\n  # Reads the \"DNB_At_Sensor_Radiance_500m\" dataset from a VNP46A1 granule into a STARS object.\n  # Then read the sinolsoidal tile x/y positions and adjust the STARS dimensions (extent+delta)\n\n  # The name of the dataset holding the nightlight band in the granule\n  dataset_name <- \"//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m\"\n\n  # From the metadata, we pull out a string containing the horizontal and vertical tile index\n  h_string <- gdal_metadata(file_name)[199]\n  v_string <- gdal_metadata(file_name)[219]\n  \n  # We parse the h/v string to pull out the integer number of h and v\n  tile_h <- as.integer(str_split(h_string, \"=\", simplify = TRUE)[[2]])\n  tile_v <- as.integer(str_split(v_string, \"=\", simplify = TRUE)[[2]])\n\n  # From the h/v tile grid position, we get the offset and the extent\n  west <- (10 * tile_h) - 180\n  north <- 90 - (10 * tile_v)\n  east <- west + 10\n  south <- north - 10\n\n  # A tile is 10 degrees and has 2400x2400 grid cells\n  delta <- 10 / 2400\n\n  # Reading the dataset\n  dnb <- read_stars(file_name, sub = dataset_name)\n\n  # Setting the CRS and applying offsets and deltas\n  st_crs(dnb) <- st_crs(4326)\n  st_dimensions(dnb)$x$delta <- delta\n  st_dimensions(dnb)$x$offset <- west\n  st_dimensions(dnb)$y$delta <- -delta\n  st_dimensions(dnb)$y$offset <- north\n  \n  return(dnb)\n}\n\n\n\nb. Invoke the function:\n\n\nShow code\n\n# Tile 1, Feb. 7\ntile1_2021038 <- \"data/VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.h5\"\ndnb1_2021038 <- read_dnb(file_name = tile1_2021038)\n\n# Tile 2, Feb. 7\ntile2_2021038 <- \"data/VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.h5\"\ndnb2_2021038 <- read_dnb(file_name = tile2_2021038)\n\n# Tile 1, Feb. 16\ntile1_2021047 <- \"data/VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.h5\"\ndnb1_2021047 <- read_dnb(file_name = tile1_2021047)\n\n# Tile 2, Feb 16\ntile2_2021047 <- \"data/VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.h5\"\ndnb2_2021047 <- read_dnb(file_name = tile2_2021047)\n\n\n\nc. Combine tiles into single raster for each date:\n\n\nShow code\n\n# Use `st_mosaic()` to combine each pair of tiles into a single `stars` object for each date.\n\nfeb_7 <- st_mosaic(dnb1_2021038, dnb2_2021038)\n\nfeb_16 <- st_mosaic(dnb1_2021047, dnb2_2021047)\n\n# Delete the previously 4 loaded objects from your environment using `rm()`.\n\nrm(dnb1_2021038, dnb1_2021047, dnb2_2021038, dnb2_2021047, tile1_2021038, tile2_2021038, tile1_2021047, tile2_2021047)\n\n\n\nd. Subtract stars objects to determine blackout locations:\n\n\nShow code\n\n# Subtract the night lights intensity after the storm from the night lights intensity before the storm to get the difference in night lights intensity caused (presumably) by the storm. Then reclassify the difference raster. Assume that any location that experienced a drop of more than 200 nW cm-2 sr-1 is a location of a blackout.\n\nlight_mask <- c(feb_7 - feb_16) > 200\nlight_mask[light_mask == FALSE] <- NA \n\n\n\ne. Vectorize the blackout mask and fix invalid geometries:\n\n\nShow code\n\nblackout_mask <- st_as_sf(light_mask) %>% \n                st_make_valid()\n\n\n\nf. Create ROI and crop the blackout dataset:\n\n\nShow code\n\n# Create the bounding box.\n\nroi_poly <- st_polygon(list(rbind(\n                  c(-96.5, 29), \n                  c(-96.5, 30.5), \n                  c(-94.5, 30.5), \n                  c(-94.5, 29), \n                  c(-96.5, 29))))\n\nroi <- st_sfc(roi_poly, crs = \"EPSG:4326\") # convert to simple feature and set coordinate system to WGS84\n\n# Crop the blackout dataset.\n\ncropped_blackout <- blackout_mask[roi, op = st_intersects]\ncropped_blackout_3083 <- st_transform(cropped_blackout, \n                                      crs = 3083) # re-project blackout dataset to NAD83\n\n\n\ng. Visualize the Feb 16th blackout:\n\n\nShow code\n\n# create a boundary of Texas Counties\ntexas_co <- tigris::counties(\"Texas\", cb = TRUE)\n#st_crs(harris_co) # check coordinate system of new object\n\n# create a boundary of Harris County\ntexas_co <- arrange(texas_co, NAME)\nharris_co <- texas_co[101,]\n\n\n\n\n\nShow code\n\n# plot region of blackouts in Harris County and adjacent areas\nblackout_roi_map <-   tm_shape(roi) +\n    tm_borders(lwd = 3) +\n  tm_shape(cropped_blackout_3083) +\n    tm_polygons() +\n  tm_shape(texas_co) +\n    tm_borders() +\n  tm_shape(harris_co) +\n    tm_borders(col =\"#F56A31\",\n               lwd = 3,\n               ) +\n  tm_scale_bar(position = c(\"right\", \"bottom\")) +\n  tm_layout(title = \"Regions without power in and adjacent to Harris County on Feb. 16, 2021\",\n            fontface = 2,\n            inner.margins=c(0,0,.075,0), \n            title.size=.8) + \n  tm_credits(\"Source: Map data copyrighted OpenStreetMap contributors\\nand available from https://www.openstreetmap.org\", # credit data source including github link; \\n creates text break\n             position = c(\"left\", \"bottom\"), \n             align = \"left\",\n             size = 0.5) +\n  tm_credits(\"G. Kumaishi & J. Parish 2021\", \n             size = 0.4,\n             position = c(\"left\", \"bottom\"))\n\nblackout_roi_map \n\n\n\n\nMap 1: Preliminary map of regions in and around Harris County, TX without power due to Winter Storm Uri on February 16, 2021. Additional analyses were completed to account for highway lights and residential buildings (see below).\n2) Access and wrangle the roads data:\nLight from highways contributes significantly to night lights visible in satellite images. To account for this, a buffer of 200m was created around all major highways in the Houston metropolitan area. Roads data was acquired using OpenStreetMap (OSM).\na. Load data using SQL query:\n\n\nShow code\n\n# Use `st_read()` to download the roads data.\n\nquery <- \"SELECT fclass, geom\n  FROM gis_osm_roads_free_1\n  WHERE fclass in (\n    'motorway', 'motorway_link', 'primary', 'primary_link'\n  )\n\"\nhighways <- st_read(\"data/gis_osm_roads_free_1.gpkg\", query = query)\n\nhighways_3083 <- st_transform(highways, crs = 3083) # re-project highways dataset to EPSG:3083\n\n\n\nb. Buffer highways by 200 meters.\n\n\nShow code\n\nhwy_buffer200m <- st_buffer(highways_3083, dist = 200)\n\n\n\nc. Dissolve buffers:\n\n\nShow code\n\n# Use st_union to dissolve buffer polygons (smooths).\n\nhwy_buffer_dissolve_3083 <- st_union(hwy_buffer200m)\n\n\n\nd. Create Houston basemap:\n\n\nShow code\n\n# Create base map for Houston:\n\npoint1 <- st_point(c(-96.5, 29))\npoint2 <- st_point(c(-96.5, 30.5))\npoint3 <- st_point(c(-94.5, 30.5))\npoint4 <- st_point(c(-94.5, 29))\ncoordinates <- list(rbind(point1, point2, point3, point4, point1))\n\npolygon_template <- st_polygon(x = coordinates)\nhouston <- st_sfc(polygon_template, crs = \"EPSG:4326\")\n\nhouston_bbox <- st_bbox(houston)\nhouston_map <- osm.raster(houston_bbox)\n\n\n\ne. Visualize highway buffers in Houston:\n\n\nShow code\n\n# Create map of Houston highway buffers.\n\nhighway_map <- tm_shape(houston_map) +\n  tm_rgb() +\n  tm_shape(hwy_buffer_dissolve_3083) +\n  tm_polygons() +\n  tm_scale_bar(position = c(\"right\", \"bottom\")) +\n  tm_layout(\"Houston, TX Highways with 200m Buffers\", \n            fontface = 2,\n            bg.color=\"#F5EDE1\",\n            inner.margins=c(0,0,.075,0), \n            title.size=.9) + \n  tm_credits(\"G. Kumaishi & J. Parish 2021\", \n            size = 0.4,\n            position = c(\"left\", \"bottom\"))\n\nhighway_map \n\n\n\n\nMap 2: Major highways in Houston, TX buffered to account for night light intensity during Winter Storm Uri.\n3) Access and wrangle the buildings data:\nBuildings data was also acquired from OSM, but relevant areas were compiled into a GeoPackage for the Houston metropolitan area alone. The dataset was loaded using a SQL query, similar to the roads data above.\na. Load data using SQL query:\n\n\nShow code\n\nbuildings <- st_read(here(\"data\", \"gis_osm_buildings_a_free_1.gpkg\"))\nquery <- \"SELECT *\n  FROM gis_osm_buildings_a_free_1\n  WHERE (type IS NULL AND name IS NULL)\n  OR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')\" \n\nresidential <- st_read(\"data/gis_osm_buildings_a_free_1.gpkg\", query = query)\n\nresidential <- st_transform(residential, crs = 3083)  # re-project to EPSG:3083\ncat(sep = \"\\n\") # add carriage returns to read out of residential data\n\n#unique(residential$fclass)\n\n\n\n4) Access and wrangle the census tract data:\nCensus tract data was obtained from the U.S. Census Bureau’s American Community Survey from 2019, and was saved as a geodatabase. Datasets were merged using dplyr’s left_join().\na. Access the census data:\n\n\nShow code\n\nacs_geoms <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                     layer = \"ACS_2019_5YR_TRACT_48_TEXAS\")\n\nacs_income <- st_read(\"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb\",\n                      layer = \"X19_INCOME\")\n\n\n\nb. Extract the GEOID and median income fields:\n\n\nShow code\n\nmedian_income <- acs_income[c(\"GEOID\", \"B19013e1\")] \n\nmedian_income <- rename(median_income, median_income = B19013e1)\n\n\n\nc. Merge geometry and income datasets:\n\n\nShow code\n\n# Merge median income with acs_geom dataset by GEOID columns.\n\nincome <- left_join(acs_geoms, median_income, by = c(\"GEOID_Data\" = \"GEOID\"))\n\nincome <- st_transform(income, crs = 3083) # re-project dataset to NAD83\n\n\n\n5) Merge the datasets\nIn order to determine the number of residential buildings that lost power during the storm, the above datasets were merged.\na. Remove the buffer from the blackout mask:\n\n\nShow code\n\n# Remove the buffer from our vectorized blackout mask using `st_difference()`.\n\nblackout_nohwy <- st_difference(cropped_blackout_3083, hwy_buffer_dissolve_3083)\n\n\n\nb. Find all residential buildings in blackout areas:\n\n\nShow code\n\n# Use spatial subsetting to find all the residential buildings in blackout areas.\n\nbuildings_blackout <- residential[blackout_nohwy, op = st_intersects] # Here is the residential data then mask with blackout data that intersects\n\n\n\nc. Spatially join the data:\n\n\nShow code\n\nacs_residential <- st_join(residential, income, join = st_intersects) # Join census income data to all buildings\n\n# Buildings impacted by blackout:\n\nacs_buildings_out <- st_join(buildings_blackout, income, join = st_intersects) # Join census income data to impacted buildings\n\n\n\n6) Analysis\nHow many residential buildings were without power on 2021-02-16?\nThere were 157,411 buildings without power on February 16, 2021 as a result of this event.\n\n\nShow code\n\nbuildings_map <- tm_shape(houston_map) +\n  tm_rgb() +\n  tm_shape(buildings_blackout) +\n  tm_polygons() +\n  tm_scale_bar(position = c(\"right\", \"bottom\")) +\n  tm_layout(title = \"Houston Residential Buildings Without Power on Feb. 16, 2021\",\n            fontface = 2,\n            bg.color=\"#D8D7D5\",\n            inner.margins=c(0,0,.075,0), \n            title.size=.9) + \n  tm_credits(\"Source: Map data copyrighted OpenStreetMap contributors\\nand available from https://www.openstreetmap.org\", # credit data source including github link; \\n creates text break\n             position = c(\"left\", \"bottom\"), \n             align = \"left\",\n             size = 0.4) +\n  tm_credits(\"G. Kumaishi & J. Parish 2021\", \n             size = 0.4,\n             position = c(\"left\", \"bottom\"))\n\nbuildings_map \n\n\n\n\nMap 3: Residential buildings in Houston, TX that lost power through February 16th, 2021 due to Winter Storm Uri.\nIs there a socioeconomic metric that predicts being affected by the power outage?\nHarris County’s power grid was not as significantly impacted by the “Texas Freeze” as the adjacent Galveston, Brazoria, Fort Bend, and Waller Counties (Busby 2021). Analyzing the median income data from the U.S. Census Bureau’s Texas census tracts shows that Houston residential areas with a higher median income were impacted more than those of neighboring lower-income areas. This may indicate that predictive factors, such as proximity to primary infrastructure grids may have more significant influence than income levels.\n\n\nShow code\n\n# Summarize by all buildings income and impacted buildings.\n\n#summary_income <- summary(acs_residential$median_income)\n\n#summary(acs_buildings_out$median_income)\n\n# map to compare residential building locations and those impacted by power outages\ncomparison_map <- tm_shape(houston_map) +\n  tm_rgb() +\n  tm_shape(acs_residential) +\n  tm_polygons(alhpa = 0.7) +\n  tm_shape(acs_buildings_out) +\n  tm_polygons(border.col = \"#EE5F42\") +\n  tm_scale_bar(position = c(\"right\", \"bottom\")) +\n  tm_layout(title = \"Comparison of Houston Households With and Without Power on Feb. 16, 2021\",\n            fontface = 4,\n            bg.color=\"#D8D7D5\",\n            inner.margins=c(0,0,.075,0),\n            title.size=.8) + \n  tm_credits(\"Source: Map data copyrighted OpenStreetMap contributors\\nand available from https://www.openstreetmap.org\", # credit data source including github link; \\n creates text break\n             position = c(\"left\", \"bottom\"), \n             align = \"left\",\n             size = 0.4) +\n  tm_credits(\"G. Kumaishi & J. Parish 2021\", \n             size = 0.4,\n             position = c(\"left\", \"bottom\"))\n\ncomparison_map \n\n\n\n\nMap 4: Houston households that retained power on February 16th, 2021 (in gray) compared with households that were without power (in red).\n\n\nShow code\n\n# Create histogram:\n\nmetric_histogram <- ggplot(acs_buildings_out, aes(x = median_income)) +\n  geom_histogram(bins = 100, color = \"black\", fill = \"#93D1DA\") +\n  geom_vline(xintercept = 81761,\n             linetype = 'dashed',\n             color = \"#444343\",\n             size = 1) +\n  annotate(\"text\", \n             label = \"Mean = $81,761\", \n             x = 105000, \n             y = 9000, \n             color = \"black\",\n             size = 3) +\n  geom_vline(xintercept = 71869,\n             color = \"black\",\n             size = 1) +\n  annotate(\"text\",\n             label = \"Median = $71,869\",\n             x = 45000,\n             y = 8200,\n             color = \"black\",\n             size = 3) +\n  scale_x_continuous(labels=scales::dollar_format()) +\n  labs(title = \"Residential Buildings Impacted by 2021 Winter Storm\",\n       subtitle = \"Houston, TX\",\n             x = \"Household Median Income\",\n             y = \"Number of Buildings Impacted\") +\n  theme_minimal()\n\nmetric_histogram\n\n\n\n\nReferences:\n“Billion-Dollar Weather and Climate Disasters: Events”. NOAA. October 2021. Retrieved October 11, 2021. https://www.ncdc.noaa.gov/billions/events/US/1980-2021.\nBusby, J. W., Baker, K., Bazilian, M. D., Gilbert, A. Q., Grubert, E., Rai, V., Rhodes, J. D., Shidore, S., Smith, C. A., & Webber, M. E. (2021). Cascading risks: Understanding the 2021 winter blackout in Texas. Energy Research & Social Science, 77, 102106. https://doi.org/10.1016/j.erss.2021.102106\nKUT, A. W. (2021, July 14). Texas Winter Storm Death Toll Goes Up To 210, Including 43 Deaths In Harris County. Houston Public Media. https://www.houstonpublicmedia.org/articles/news/energy-environment/2021/07/14/403191/texas-winter-storm-death-toll-goes-up-to-210-including-43-deaths-in-harris-county/\nOpenStreetMap contributors. (2015) Planet dump [Data file from October 24, 2021]. Retrieved from https://planet.openstreetmap.org\nU.S. Census Bureau’s American Community Survey for Texas census tracts in 2019 Census—Table Results. (n.d.). Retrieved October 24, 2021, from https://data.census.gov/cedsci/table?q=DP03&tid=ACSDP1Y2019.DP03\nWatson, K., Cross, R., Jones, M., Buttorff, G., Pinto, O., Sipole, S. Vallejo, A. (2021) The Effects of the Winter Storm of 2021 in Harris County. University of Houston. Retrieved October 24, 2021 from https://uh.edu/hobby/winter2021/harriswinter.pdf.\n\n\n\n",
    "preview": "posts/2021-10-25-winterstormuri/images/comparison_map.png",
    "last_modified": "2022-01-30T14:48:14-08:00",
    "input_file": "winter_storm_uri.knit.md",
    "preview_width": 2582,
    "preview_height": 2100
  }
]
